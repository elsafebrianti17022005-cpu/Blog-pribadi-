<!DOCTYPE html><html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Dark Space</title><style>
:root{--bg:#0f1115;--card:#181b22;--accent:#8b5cf6;--text:#e5e7eb}
body{margin:0;background:var(--bg);color:var(--text);font-family:sans-serif}
.center{height:100vh;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:15px}
button{background:var(--accent);border:none;color:white;padding:10px 16px;border-radius:12px}
input,textarea{background:#111;border:1px solid #333;color:white;border-radius:10px;padding:10px;width:100%}
#blog{display:none;padding:20px;max-width:700px;margin:auto}
.card{background:var(--card);padding:15px;border-radius:18px;margin-bottom:20px;animation:fade .25s ease}
@keyframes fade{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:none}}
.caption{outline:none;padding:6px;border-radius:8px}
.caption:focus{background:#111}
.mediaRow{display:flex;gap:12px;overflow-x:auto;padding-top:10px}
.mediaRow img,.mediaRow video{height:220px;border-radius:12px}
.mediaRow audio{width:220px}
.mediaWrap{position:relative}
.mediaWrap button{position:absolute;bottom:6px;right:6px;padding:4px 10px;background:#000a;border-radius:10px}
.topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
/* modal */
#confirmBox{position:fixed;inset:0;background:#0008;display:none;align-items:center;justify-content:center}
.confirmCard{background:var(--card);padding:20px;border-radius:18px;text-align:center;max-width:260px}
.confirmBtns{display:flex;gap:10px;justify-content:center;margin-top:15px}
</style></head>
<body><div id="login" class="center">
<h1>ðŸŒ™ My Private Space</h1>
<input id="pass" type="password" placeholder="password">
<button onclick="enter()">Masuk</button>
</div><div id="blog">
<div class="topbar"><h2>Blogku</h2><button onclick="location.reload()">Keluar</button></div>
<div class="card"><textarea id="text" placeholder="Tulis isi pikiran..."></textarea>
<input id="file" type="file" multiple accept="image/*,video/*,audio/*">
<button onclick="addPost()">Posting</button></div>
<div id="posts"></div>
</div><div id="confirmBox"><div class="confirmCard"><div id="confirmText">Yakin?</div><div class="confirmBtns"><button onclick="confirmYes()">Iya</button><button onclick="closeConfirm()">Tidak</button></div></div></div><script>
const PASSWORD="31082025";
let db,confirmAction=null;

const req=indexedDB.open("darkBlog",2);
req.onupgradeneeded=e=>{db=e.target.result;if(!db.objectStoreNames.contains("posts"))db.createObjectStore("posts",{keyPath:"id",autoIncrement:true})};
req.onsuccess=e=>{db=e.target.result;render()};

function ask(text,action){confirmText.textContent=text;confirmBox.style.display="flex";confirmAction=action}
function confirmYes(){confirmBox.style.display="none";confirmAction&&confirmAction()}
function closeConfirm(){confirmBox.style.display="none"}

function enter(){if(pass.value===PASSWORD){login.style.display="none";blog.style.display="block";render()}else alert("Password salah")}

function getAll(){return new Promise(res=>{const tx=db.transaction("posts","readonly");const r=tx.objectStore("posts").getAll();r.onsuccess=()=>res(r.result.sort((a,b)=>b.id-a.id))})}
function save(post){return new Promise(res=>{const tx=db.transaction("posts","readwrite");tx.objectStore("posts").put(post);tx.oncomplete=res})}
function del(id){ask("Hapus postingan ini?",()=>{const tx=db.transaction("posts","readwrite");tx.objectStore("posts").delete(id);render()})}

async function addPost(){const files=[...file.files];let media=[];for(const f of files)media.push({type:f.type,blob:f});await save({text:text.value,media});text.value="";file.value="";render()}

async function addMedia(id,input){const files=[...input.files];if(!files.length)return;const posts=await getAll();const post=posts.find(p=>p.id==id);files.forEach(f=>post.media.push({type:f.type,blob:f}));await save(post);input.value="";render()}

async function delMedia(id,i){ask("Hapus media ini?",async()=>{const posts=await getAll();const post=posts.find(p=>p.id==id);post.media.splice(i,1);await save(post);render()})}

function fileURL(file){return URL.createObjectURL(file)}

async function render(){if(!db)return;const wrap=document.getElementById("posts");wrap.innerHTML="";const posts=await getAll();
posts.forEach(post=>{
const card=document.createElement("div");card.className="card";

const cap=document.createElement("div");cap.className="caption";cap.contentEditable=true;cap.textContent=post.text||"Klik untuk menulis...";
cap.oninput=async()=>{post.text=cap.textContent;await save(post)};card.appendChild(cap);

if(post.media?.length){const row=document.createElement("div");row.className="mediaRow";
post.media.forEach((m,i)=>{const w=document.createElement("div");w.className="mediaWrap";let el;const url=fileURL(m.blob);
if(m.type.startsWith("image")){el=document.createElement("img");el.src=url}
else if(m.type.startsWith("video")){el=document.createElement("video");el.src=url;el.controls=true;el.playsInline=true;el.preload="metadata";el.onplay=()=>document.querySelectorAll("video").forEach(v=>{if(v!==el)v.pause()})}
else if(m.type.startsWith("audio")){el=document.createElement("audio");el.src=url;el.controls=true;el.preload="metadata"}
w.appendChild(el);
const delBtn=document.createElement("button");delBtn.textContent="<";delBtn.onclick=()=>delMedia(post.id,i);w.appendChild(delBtn);
row.appendChild(w)});
card.appendChild(row)}

const inp=document.createElement("input");inp.type="file";inp.multiple=true;inp.accept="image/*,video/*,audio/*";inp.onchange=()=>addMedia(post.id,inp);card.appendChild(inp);

const delPost=document.createElement("button");delPost.textContent="<";delPost.onclick=()=>del(post.id);card.appendChild(delPost);
wrap.appendChild(card)})}
</script></body>
</html>
